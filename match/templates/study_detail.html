{% extends 'base.html' %}
{% load static %}
<html lang="en">
<head>
    {% block css %}
    <title>ê²Œì‹œê¸€ì •ë³´</title>
    <link rel = "stylesheet" href = "{% static 'css/match_detail.css' %}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    {% endblock css %}
</head>


<body>

{% block content %}


<div class = "main_content">

    <div class = "top_content">
        <div class = "top_content_title">
            ì œëª©
        </div>

        <div class = "top_content_real_title">
            {{ recruit.recruit_title }}  <!-- ì‹¤ì œ ì œëª© -->
        </div>

        <div class = "top_content_date">
            D-
            <label id = "today">
                {{ recruit.recruit_period_end }}</label> <!-- ëª¨ì§‘ ë‚ ì§œ (ë§ˆê°) -->
        </div>

    </div>

    <div class = "user_image"> <!--ê²Œì‹œê¸€ì´ë¯¸ì§€ì— ëŒ€í•œ ì •ë³´ -->

        {% if recruit.recruit_image %}
        <img src="{{ recruit.recruit_image.url }}" alt="ìœ ì €ì´ë¯¸ì§€" style="width:50%;">
        {% endif %}
    </div>

    <div class = "recruit_info">
        <div> <!--ì‘ì„±ì ë‹‰ë„¤ì„ -->
            <label style="color:black;">ì‘ì„±ì</label>
            <div>{{ recruit.recruit_writer.nickname }}</div>
        </div>
        <div> <!--ê²Œì‹œê¸€ ë‚´ìš© -->
            <label style="color:black;font-size:1vw;">ë‚´ìš©</label>
                <div readonly id = "Textarea" style="height:35vh;width:89%;color:black;font-weight:400;overflow:scroll;">{{recruit.recruit_content|safe}}</div>
            </div>
        <div> <!-- ëª¨ì§‘ ë¶„ì•¼ -->
            <label style="color:black;">ëª¨ì§‘ ë¶„ì•¼</label>
            <div>{{ recruit.recruit_field }}</div>
        </div>
        <div> <!-- ëª¨ì§‘ ìƒíƒœ -->
            <label style="color:black;">ëª¨ì§‘ ìƒíƒœ</label>
            <div>{{ recruit.recruit_status }}</div>
        </div>
        <div><!-- ëª¨ì§‘ ê¸°ê°„ -->
            <label style="color:black;">ëª¨ì§‘ ê¸°ê°„</label>
            <div>{{ recruit.recruit_period_start }} ~ {{ recruit.recruit_period_end }}</div>
        </div>
        <div> <!-- ëª¨ì§‘ ì¸ì› -->
            <label style="color:black;">ëª¨ì§‘ ì¸ì›</label>
            <div>{{ recruit.recruit_number }}</div>
        </div>
        <div> <!-- ëŒ€ë©´ì—¬ë¶€ -->
            <label style="color:black;">ëŒ€ë©´ ì—¬ë¶€</label>
            <div>{{ recruit.recruit_meeting }}</div>
        </div>
        <div> <!-- í•´ì‹œíƒœê·¸ -->
            <label style="color:black;">í•´ì‰¬íƒœê·¸</label>
            <div>
                {% for hashtag in recruit.recruit_hashtag.all %}
                    {{ hashtag.hashtag_content }}
                {% endfor %}
            </div>
        </div>

        <div> <!-- í•´ì‹œíƒœê·¸ë¥¼ ì‘ì„±í•˜ëŠ” Form -->
            {% if recruit.recruit_writer == user %}

            <form method = "POST" action="{% url 'hashtag_write' recruit.id %}" style="color:black;">
                {% csrf_token %}
                {{ hashtag_form.as_p }}
                <input type="submit" value = "ì¶”ê°€" class = "hash_add">
            </form>
            {% endif %}
            {% for hashtag in recruit.hashtags.all %}
            {{ hashtag.hashtag_content }}
            {% endfor %}
        </div>
    </div>

    <!-- ì¢‹ì•„ìš” -->
    <p>ğŸ’š
    {{ recruit.like.count }}
    </p>
    <a href="{% url 'likes' recruit.id %}" style="text-decoration:none;">
        {% if user in recruit.like.all %}
        <span style="text-decoration:none; color:#51a998;" id = "comment_like_cancel">ì·¨ì†Œ</span>
        {% else %}
            ğŸ’š<span id = "comment_like_number" style="text-decoration:none;">ì¢‹ì•„ìš”</span>
        {% endif %}
    </a>
    <br><br>

    <!-- ë§Œì•½ ì‘ì„±ìê°€ í˜„ì¬ userì™€ ë™ì¼í•˜ë‹¤ë©´ ìˆ˜ì •, ì‚­ì œë¥¼ ë„ìš°ê¸° -->
    {% if recruit.recruit_writer == user %}
    <div class = "button_list">
        <!-- ê²Œì‹œê¸€ ìˆ˜ì • -->
        <a href="{% url 'study_edit' recruit.id %}" class = "modify">ìˆ˜ì •</a>

        <!-- ê²Œì‹œê¸€ ì‚­ì œ -->
        <a href="{% url 'study_delete' recruit.id %}" class = "delete">ì‚­ì œ</a>
    </div>
    {% endif %}
</div>

<!-- ê°€ì… -->
{% if recruit.recruit_writer != user %}
<form method = "POST" action="{% url 'recruit_user' recruit.id %}">
    {% csrf_token %}
    {{ recruit_user_form.as_p }}
    <input type="submit" value="ê°€ì…">
</form>
    {% for recruit_user in recruit.recruit_users.all %}
    {% if recruit_user.recruit_user_register == user %}
        ê°€ì…ë˜ì—ˆìŠµë‹ˆë‹¤.
    {% endif %}
    {% endfor %}
{% elif recruit.recruit_writer == user %}
    ëŒ€í‘œ: {{ recruit.recruit_writer.nickname }} <br>
    {% for recruit_user in recruit.recruit_users.all %}
        {{ recruit_user.recruit_user_register.nickname }} <br>
    {% endfor %}
{% endif %}

<!-- ë¶ë§ˆí¬ -->
{% if recruit.recruit_writer != user %}
<form method = "POST" action="{% url 'bookmark' recruit.id %}">
    {% csrf_token %}
    {{ bookmark_form.as_p }}
    <input type="submit" value="ë¶ë§ˆí¬">
</form>
    {% for bookmark in recruit.recruit_bookmark.all %}
    {% if bookmark.bookmark_user == user %}
        ë¶ë§ˆí¬ ë˜ì—ˆìŠµë‹ˆë‹¤.
    {% endif %}
    {% endfor %}
{% endif %}
<hr>


<div class = "comment_container">
    {% for comment in recruit.comments.all %}
        {% if comment.comment_writer.profile_image %}
            {% if comment.comment_writer == user %}

                ì‘ì„±ì <img src="{{ comment.comment_writer.profile_image.url }}" alt="image" width="20" height="20"> {{ comment.comment_writer.nickname }} : {{ comment.comment_content }} / {{ comment.comment_date}}
            {% else %}
                <img src="{{ comment.comment_writer.profile_image.url }}" alt="image" width="20" height="20"> {{ comment.comment_writer.nickname }} : {{ comment.comment_content }} / {{ comment.comment_date}} 
            {% endif %}
        {% endif %}

        {% if comment.comment_writer == user %}
            <div style="margin:2% auto">
            <a href="{% url 'comment_edit' recruit.id comment.id %}" class = "comment_modify">ìˆ˜ì •</a>
            <a href="{% url 'comment_delete' recruit.id comment.id %}" class = "comment_delete">ì‚­ì œ</a>
            </div>
        {% endif %}

        {% for recomment in comment.recomments.all %}
            {% if recomment.recomment_writer == user %}
                â†ª ì‘ì„±ì <img src="{{ comment.comment_writer.profile_image.url }}" alt="image" width="20" height="20"> : {{ recomment.recomment_writer.nickname }} / {{ recomment.recomment_content }} <br>
            {% else %}
                â†ª <img src="{{ comment.comment_writer.profile_image.url }}" alt="image" width="20" height="20"> : {{ recomment.recomment_writer.nickname }} / {{ recomment.recomment_content }} <br>
            {% endif %}
        {% endfor %}

        <form method = "POST" action="{% url 'recomment_write' recruit.id comment.id %}">
            {% csrf_token %}
            {{ re_form.as_p }}
            <input type="submit" value = "ë‹µê¸€ ì‘ì„±">
        </form>
    {% endfor %}

<form method="POST" action = "{% url 'study_detail' recruit.id %}">
    {% csrf_token %}
    {{ form.as_p }}
    <div class="button">
        <input type="submit" value="ëŒ“ê¸€ ì‘ì„±" id = "comment_submit">
    </div>
</form>
</div>

<script src = "{% static 'js/match_detail.js' %}"></script>
{% endblock %}

</body>
</html>
