<h1>Study Detail</h1>

<!-- 작성한 글을 띄우는 것 -->
제목 {{ recruit.recruit_title }} <br>
작성자 {{ recruit.recruit_writer.nickname }} <br>
{% if recruit.recruit_image %}
    <img src="{{ recruit.recruit_image.url }}" alt="image"> <br>
{% endif %}
글내용 {{ recruit.recruit_content | safe}} <br>
모집분야 {{ recruit.get_recruit_field_display }} <br>
모집여부 {{ recruit.get_recruit_status_display }} <br>
모집기간 {{ recruit.recruit_period_start }} ~ {{ recruit.recruit_period_end }} <br>
모집인원 {{ recruit.recruit_number }} <br>
대면여부 {{ recruit.get_recruit_meeting_display }} <br>
해시태그 
{% for hashtag in recruit.recruit_hashtag.all %}
    {{ hashtag.hashtag_content }}
{% endfor %}
<!-- 만약 작성자가 현재 user와 동일하다면 수정, 삭제를 띄우기 -->
{% if recruit.recruit_writer == user %}
    <a href="{% url 'study_edit' recruit.id %}">수정</a>
    <a href="{% url 'study_delete' recruit.id %}">삭제</a> 
{% endif %}

<br>
<!-- 해시태그를 작성하는 Form -->
{% if recruit.recruit_writer == user %}
    <form method = "POST" action="{% url 'hashtag_write' recruit.id %}">
        {% csrf_token %}
        {{ hashtag_form.hashtag_content }}
        <input type="submit">
    </form>
{% endif %}

<!-- 좋아요 -->
{{ recruit.like.count }}
<a href="{% url 'likes' recruit.id %}">
    {% if user in recruit.like.all %}
    취소
    {% else %}
    ❤️좋아요
    {% endif %}
</a>
<br><br>

{% if recruit.recruit_writer != user %}
<form method = "POST" action="{% url 'recruit_user' recruit.id %}">
    {% csrf_token %}
    {{ recruit_user_form.as_p }}
    <input type="submit" value="가입">
</form>
    {% for recruit_user in recruit.recruit_users.all %}
    {% if recruit_user.recruit_user_register == user %}
        가입되었습니다.
    {% endif %}
    {% endfor %}
{% elif recruit.recruit_writer == user %}
    대표: {{ recruit.recruit_writer.nickname }} <br>
    {% for recruit_user in recruit.recruit_users.all %}
        {{ recruit_user.recruit_user_register.nickname }} <br>
    {% endfor %}
{% endif %}

{% if recruit.recruit_writer != user %}
<form method = "POST" action="{% url 'bookmark' recruit.id %}">
    {% csrf_token %}
    {{ bookmark_form.as_p }}
    <input type="submit" value="북마크">
</form>
    {% for bookmark in recruit.recruit_bookmark.all %}
    {% if bookmark.bookmark_user == user %}
        북마크 되었습니다.
    {% endif %}
    {% endfor %}
{% endif %}
<hr>

{% for comment in recruit.comments.all %}
    {% if comment.comment_writer.profile_image %}
        {% if comment.comment_writer == user %}
            작성자 <img src="{{ comment.comment_writer.profile_image.url }}" alt="image" width="20" height="20"> {{ comment.comment_writer.nickname }} : {{ comment.comment_content }} / {{ comment.comment_date}} 
        {% else %}
            <img src="{{ comment.comment_writer.profile_image.url }}" alt="image" width="20" height="20"> {{ comment.comment_writer.nickname }} : {{ comment.comment_content }} / {{ comment.comment_date}} 
        {% endif %}
    {% else %}
        {% if comment.comment_writer == user %}
            작성자 {{ comment.comment_writer.nickname }} : {{ comment.comment_content }} / {{ comment.comment_date}}
        {% else %}
            {{ comment.comment_writer.nickname }} : {{ comment.comment_content }} / {{ comment.comment_date}} 
        {% endif %}
    {% endif %}

    {% if comment.comment_writer == user %}
        {% if comment_id == recruit.comments.id %}
        <form method = "POST">
            {% csrf_token %}
            {{ form.as_p}}
            <div class="button">
                <input type="submit" value="댓글 작성">
            </div>
        </form>
        {% endif %}
        <a href="{% url 'comment_delete' recruit.id comment.id %}">삭제</a> <br>
    {% endif %}

    {% for recomment in comment.recomments.all %}
        {% if recomment.recomment_writer.profile_image %}
            {% if recomment.recomment_writer == user %}
                ↪ 작성자 <img src="{{ comment.comment_writer.profile_image.url }}" alt="image" width="20" height="20"> : {{ recomment.recomment_writer.nickname }} / {{ recomment.recomment_content }} <br>
            {% else %}
                ↪ <img src="{{ comment.comment_writer.profile_image.url }}" alt="image" width="20" height="20"> : {{ recomment.recomment_writer.nickname }} / {{ recomment.recomment_content }} <br>
            {% endif %}
        {% else %}
            {% if recomment.recomment_writer == user %}
                ↪ 작성자 : {{ recomment.recomment_writer.nickname }} / {{ recomment.recomment_content }} <br>
            {% else %}
                ↪ : {{ recomment.recomment_writer.nickname }} / {{ recomment.recomment_content }} <br>
            {% endif %}
        {% endif %}
    {% endfor %}

    <form method = "POST" action="{% url 'recomment_write' recruit.id comment.id %}">
        {% csrf_token %}
        {{ re_form.as_p }}
        <input type="submit" value = "답글 작성">
    </form>
{% endfor %}